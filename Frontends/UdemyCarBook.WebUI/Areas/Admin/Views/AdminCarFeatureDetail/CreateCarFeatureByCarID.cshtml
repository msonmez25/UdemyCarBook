@model List<ResultFeatureDto>
@{
    ViewData["Title"] = "Araç Özellikleri";
    Layout = "~/Views/AdminLayout/Index.cshtml";
}

<style>
    .page-header-card {
        background: #fff;
        border-radius: 15px;
        padding: 20px 25px;
        margin-bottom: 25px;
        box-shadow: 0 5px 20px rgba(0,0,0,0.05);
        border-left: 5px solid #667eea;
    }

    .features-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
        gap: 20px;
    }

    .feature-check-card {
        background: #ffffff;
        border-radius: 14px;
        padding: 18px;
        box-shadow: 0 8px 25px rgba(0,0,0,0.06);
        border: 2px solid transparent;
        cursor: pointer;
        transition: all .3s ease;
    }

        .feature-check-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 30px rgba(0,0,0,0.10);
        }

        .feature-check-card.checked {
            border-color: #667eea;
            background: linear-gradient(135deg, #f5f7ff, #eef1ff);
        }

    .feature-content-wrapper {
        display: flex;
        justify-content: space-between;
        align-items: center;
        gap: 10px;
    }

    .feature-check-container {
        display: flex;
        align-items: center;
        gap: 10px;
        font-weight: 600;
        color: #2c3e50;
    }

        .feature-check-container input[type="checkbox"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

    .status-badge {
        padding: 6px 14px;
        border-radius: 20px;
        font-size: 12px;
        font-weight: 700;
        min-width: 70px;
        text-align: center;
    }

    .status-active {
        background: linear-gradient(135deg, #38ef7d, #11998e);
        color: #fff;
    }

    .status-inactive {
        background: #e0e0e0;
        color: #555;
    }

    .selection-counter-top {
        position: fixed;
        top: 90px;
        right: 30px;
        background: linear-gradient(135deg, #667eea, #764ba2);
        color: #fff;
        padding: 12px 18px;
        border-radius: 14px;
        text-align: center;
        box-shadow: 0 8px 25px rgba(0,0,0,0.25);
        z-index: 999;
    }

    .counter-number {
        font-size: 26px;
        font-weight: 800;
        line-height: 1;
    }

    .counter-text {
        font-size: 13px;
        opacity: .9;
    }

    .button-container {
        margin-top: 30px;
        display: flex;
        justify-content: space-between;
        flex-wrap: wrap;
        gap: 15px;
    }

    .btn-save {
        background: linear-gradient(135deg, #667eea, #764ba2);
        color: #fff;
        border: none;
        padding: 12px 28px;
        border-radius: 30px;
        font-weight: 700;
        transition: .3s;
    }

        .btn-save:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
        }

    .btn-back {
        background: #f1f1f1;
        padding: 12px 28px;
        border-radius: 30px;
        font-weight: 700;
        color: #333;
        text-decoration: none;
    }

        .btn-back:hover {
            background: #e4e4e4;
        }
</style>

<div class="page-content">
    <div class="container-fluid">

        <!-- BAŞLIK -->
        <div class="page-header-card">
            <h4 class="mb-1">
                <i class="fas fa-list-check text-primary me-2"></i>
                Araç Özellikleri Seçimi
            </h4>
            <p class="text-muted mb-0">
                Araca tanımlamak istediğiniz özellikleri aşağıdan seçebilirsiniz.
            </p>
        </div>

        <!-- SEÇİM SAYACI -->
        <div class="selection-counter-top" id="selectionCounter" style="display:none;">
            <div class="counter-number" id="selectedCount">0</div>
            <div class="counter-text">özellik seçildi</div>
        </div>

        <form method="post">

            <!-- GRID -->
            <div class="features-grid">
                @for (int i = 0; i < Model.Count; i++)
                {
                    <div class="feature-check-card">
                        <div class="feature-content-wrapper">

                            <div class="feature-check-container">
                                <input type="hidden" asp-for="@Model[i].FeatureID" />
                                <input type="hidden" asp-for="@Model[i].Name" />

                                <input type="checkbox"
                                       class="form-check-input"
                                       name="SelectedFeatures"
                                       value="@Model[i].FeatureID"
                                       id="feature_@i" />

                                <label for="feature_@i">
                                    @Model[i].Name
                                </label>
                            </div>

                            <div class="status-badge status-inactive">
                                PASİF
                            </div>

                        </div>
                    </div>
                }
            </div>

            <!-- BUTONLAR -->
            <div class="button-container">
                <button type="submit" class="btn-save">
                    <i class="fas fa-check-circle me-1"></i>
                    Araca Özellikleri Tanımla
                </button>

                <a href="/Admin/AdminCar" class="btn-back">
                    <i class="fas fa-arrow-left me-1"></i>
                    Araç Listesine Dön
                </a>
            </div>

        </form>

    </div>
</div>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<script>
    let selectedCount = 0;

    $('.form-check-input').change(function () {
        const card = $(this).closest('.feature-check-card');
        const badge = card.find('.status-badge');

        if ($(this).is(':checked')) {
            card.addClass('checked');
            badge.removeClass('status-inactive')
                 .addClass('status-active')
                 .text('AKTİF');
            selectedCount++;
        } else {
            card.removeClass('checked');
            badge.removeClass('status-active')
                 .addClass('status-inactive')
                 .text('PASİF');
            selectedCount--;
        }

        $('#selectedCount').text(selectedCount);
        selectedCount > 0
            ? $('#selectionCounter').fadeIn()
            : $('#selectionCounter').fadeOut();
    });

    $('.feature-check-card').click(function (e) {
        if (!$(e.target).is('input, label')) {
            $(this).find('.form-check-input')
                   .prop('checked', function (i, val) { return !val; })
                   .trigger('change');
        }
    });
</script>
